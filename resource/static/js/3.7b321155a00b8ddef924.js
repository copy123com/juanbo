webpackJsonp([3],{"2W7w":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Gu7T"),a=i.n(n),o=i("Xxa5"),r=i.n(o),s=i("exGp"),l=i.n(s),c=i("//Fk"),u=i.n(c),f=(i("IcnI"),i("mtWM")),p=i.n(f),m={data:function(){return{form:{content:"",title:"",img:""},previewVisible:!1,previewImage:"",fileList:[]}},methods:{onSubmit:function(){var e=this,t=this;if(t.fileList.forEach(function(e){t.form.img=e.originFileObj}),""!==this.form.title)if(""!==this.form.content){this.form.uid=localStorage.getItem("uid");var i=localStorage.getItem("token"),n=t.form,a=new FormData;a.append("img",n.img),a.append("content",n.content),a.append("title",n.title),a.append("img",n.img),a.append("uid",n.uid);var o=p.a.create({baseURL:"https://test.zhihao1.cn/api"});o.interceptors.request.use(function(e){return e.headers={token:i,"Content-Type":"multipart/form-data"},e},function(e){return u.a.reject(e)}),this.$message.loading("正在提交",2).then(function(){o({url:"/content/add",method:"post",data:a}).then(function(t){console.log("2"),200==t.status&&(e.$message.success("提交成功"),e.$router.push("/home"),console.log(t))}).catch(function(e){console.log(e)})}),this.uploading=!0}else this.$message.info("内容不能为空");else this.$message.info("标题不能为空")},handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){var t=this;return l()(r.a.mark(function i(){return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e.url||e.preview){i.next=4;break}return i.next=3,getBase64(e.originFileObj);case 3:e.preview=i.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return i.stop()}},i,t)}))()},handleChange:function(e){var t=e.fileList;this.fileList=t},beforeUpload:function(e){return this.fileList=[].concat(a()(this.fileList),[e]),!1},back:function(){this.$router.back()}}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("header",{staticClass:"header"},[i("a-icon",{staticClass:"iLeft",attrs:{type:"left"},on:{click:e.back}}),e._v(" "),i("h3",{staticClass:"tab"},[e._v("我要提问")])],1),e._v(" "),i("a-form-model",{attrs:{model:e.form}},[i("a-form-model-item",[i("a-input",{staticClass:"title",attrs:{type:"text",placeholder:"请输入标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),i("a-form-model-item",[i("a-input",{attrs:{type:"textarea",placeholder:"发表问题..."},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),i("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[i("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})]),e._v(" "),i("a-upload",{attrs:{beforeUpload:e.beforeUpload,listType:"picture-card",fileList:e.fileList},on:{preview:e.handlePreview,change:e.handleChange}},[e.fileList.length<8?i("div",[i("a-icon",{attrs:{type:"plus"}}),e._v(" "),i("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1):e._e()]),e._v(" "),i("a-form-model-item",{staticClass:"button"},[i("a-button",{on:{click:e.onSubmit}},[e._v("\r\n      发表\r\n    ")])],1)],1)],1)},staticRenderFns:[]};var h=i("VU/8")(m,d,!1,function(e){i("uygB")},"data-v-592fc191",null);t.default=h.exports},uygB:function(e,t){}});
//# sourceMappingURL=3.7b321155a00b8ddef924.js.map